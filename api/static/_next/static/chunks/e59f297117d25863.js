(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},98183,(e,t,s)=>{"use strict";function a(e){let t={};for(let[s,a]of e.entries()){let e=t[s];void 0===e?t[s]=a:Array.isArray(e)?e.push(a):t[s]=[e,a]}return t}function r(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function n(e){let t=new URLSearchParams;for(let[s,a]of Object.entries(e))if(Array.isArray(a))for(let e of a)t.append(s,r(e));else t.set(s,r(a));return t}function l(e){for(var t=arguments.length,s=Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];for(let t of s){for(let s of t.keys())e.delete(s);for(let[s,a]of t.entries())e.append(s,a)}return e}Object.defineProperty(s,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(s,{assign:function(){return l},searchParamsToUrlQuery:function(){return a},urlQueryToSearchParams:function(){return n}})},95057,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(s,{formatUrl:function(){return n},formatWithValidation:function(){return i},urlObjectKeys:function(){return l}});let a=e.r(90809)._(e.r(98183)),r=/https?|ftp|gopher|file/;function n(e){let{auth:t,hostname:s}=e,n=e.protocol||"",l=e.pathname||"",i=e.hash||"",o=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:s&&(c=t+(~s.indexOf(":")?"["+s+"]":s),e.port&&(c+=":"+e.port)),o&&"object"==typeof o&&(o=String(a.urlQueryToSearchParams(o)));let d=e.search||o&&"?"+o||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||r.test(n))&&!1!==c?(c="//"+(c||""),l&&"/"!==l[0]&&(l="/"+l)):c||(c=""),i&&"#"!==i[0]&&(i="#"+i),d&&"?"!==d[0]&&(d="?"+d),""+n+c+(l=l.replace(/[?#]/g,encodeURIComponent))+(d=d.replace("#","%23"))+i}let l=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function i(e){return n(e)}},18581,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"useMergedRef",{enumerable:!0,get:function(){return r}});let a=e.r(71645);function r(e,t){let s=(0,a.useRef)(null),r=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=s.current;e&&(s.current=null,e());let t=r.current;t&&(r.current=null,t())}else e&&(s.current=n(e,a)),t&&(r.current=n(t,a))},[e,t])}function n(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let s=e(t);return"function"==typeof s?s:()=>e(null)}}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},18967,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(s,{DecodeError:function(){return f},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return g},NormalizeError:function(){return h},PageNotFoundError:function(){return b},SP:function(){return p},ST:function(){return x},WEB_VITALS:function(){return a},execOnce:function(){return r},getDisplayName:function(){return c},getLocationOrigin:function(){return i},getURL:function(){return o},isAbsoluteUrl:function(){return l},isResSent:function(){return d},loadGetInitialProps:function(){return m},normalizeRepeatedSlashes:function(){return u},stringifyError:function(){return y}});let a=["CLS","FCP","FID","INP","LCP","TTFB"];function r(e){let t,s=!1;return function(){for(var a=arguments.length,r=Array(a),n=0;n<a;n++)r[n]=arguments[n];return s||(s=!0,t=e(...r)),t}}let n=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>n.test(e);function i(){let{protocol:e,hostname:t,port:s}=window.location;return e+"//"+t+(s?":"+s:"")}function o(){let{href:e}=window.location,t=i();return e.substring(t.length)}function c(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function d(e){return e.finished||e.headersSent}function u(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function m(e,t){let s=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await m(t.Component,t.ctx)}:{};let a=await e.getInitialProps(t);if(s&&d(s))return a;if(!a)throw Object.defineProperty(Error('"'+c(e)+'.getInitialProps()" should resolve to an object. But found "'+a+'" instead.'),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return a}let p="undefined"!=typeof performance,x=p&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class f extends Error{}class h extends Error{}class b extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class g extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function y(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"isLocalURL",{enumerable:!0,get:function(){return n}});let a=e.r(18967),r=e.r(52817);function n(e){if(!(0,a.isAbsoluteUrl)(e))return!0;try{let t=(0,a.getLocationOrigin)(),s=new URL(e,t);return s.origin===t&&(0,r.hasBasePath)(s.pathname)}catch(e){return!1}}},84508,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"errorOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},22016,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(s,{default:function(){return h},useLinkStatus:function(){return g}});let a=e.r(90809),r=e.r(43476),n=a._(e.r(71645)),l=e.r(95057),i=e.r(8372),o=e.r(18581),c=e.r(18967),d=e.r(5550);e.r(33525);let u=e.r(91949),m=e.r(73668),p=e.r(99781);e.r(84508);let x=e.r(65165);function f(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}function h(e){var t;let s,a,l,[h,g]=(0,n.useOptimistic)(u.IDLE_LINK_STATUS),j=(0,n.useRef)(null),{href:y,as:N,children:v,prefetch:_=null,passHref:w,replace:k,shallow:S,scroll:C,onClick:P,onMouseEnter:T,onTouchStart:E,legacyBehavior:L=!1,onNavigate:A,ref:O,unstable_dynamicOnHover:M,...R}=e;s=v,L&&("string"==typeof s||"number"==typeof s)&&(s=(0,r.jsx)("a",{children:s}));let F=n.default.useContext(i.AppRouterContext),D=!1!==_,I=!1!==_?null===(t=_)||"auto"===t?x.FetchStrategy.PPR:x.FetchStrategy.Full:x.FetchStrategy.PPR,{href:U,as:z}=n.default.useMemo(()=>{let e=f(y);return{href:e,as:N?f(N):e}},[y,N]);L&&(a=n.default.Children.only(s));let B=L?a&&"object"==typeof a&&a.ref:O,q=n.default.useCallback(e=>(null!==F&&(j.current=(0,u.mountLinkInstance)(e,U,F,I,D,g)),()=>{j.current&&((0,u.unmountLinkForCurrentNavigation)(j.current),j.current=null),(0,u.unmountPrefetchableInstance)(e)}),[D,U,F,I,g]),W={ref:(0,o.useMergedRef)(q,B),onClick(e){L||"function"!=typeof P||P(e),L&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(e),F&&(e.defaultPrevented||function(e,t,s,a,r,l,i){let{nodeName:o}=e.currentTarget;if(!("A"===o.toUpperCase()&&function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||e.currentTarget.hasAttribute("download"))){if(!(0,m.isLocalURL)(t)){r&&(e.preventDefault(),location.replace(t));return}if(e.preventDefault(),i){let e=!1;if(i({preventDefault:()=>{e=!0}}),e)return}n.default.startTransition(()=>{(0,p.dispatchNavigateAction)(s||t,r?"replace":"push",null==l||l,a.current)})}}(e,U,z,j,k,C,A))},onMouseEnter(e){L||"function"!=typeof T||T(e),L&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),F&&D&&(0,u.onNavigationIntent)(e.currentTarget,!0===M)},onTouchStart:function(e){L||"function"!=typeof E||E(e),L&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),F&&D&&(0,u.onNavigationIntent)(e.currentTarget,!0===M)}};return(0,c.isAbsoluteUrl)(z)?W.href=z:L&&!w&&("a"!==a.type||"href"in a.props)||(W.href=(0,d.addBasePath)(z)),l=L?n.default.cloneElement(a,W):(0,r.jsx)("a",{...R,...W,children:s}),(0,r.jsx)(b.Provider,{value:h,children:l})}let b=(0,n.createContext)(u.IDLE_LINK_STATUS),g=()=>(0,n.useContext)(b);("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},93963,75254,e=>{"use strict";e.s(["Header",()=>x],93963);var t=e.i(43476),s=e.i(22016);e.s(["default",()=>o],75254);var a=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:r,height:r,stroke:s,strokeWidth:o?24*Number(i)/Number(r):i,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let s=(0,a.forwardRef)((s,l)=>{let{className:o,...c}=s;return(0,a.createElement)(i,{ref:l,iconNode:t,className:n("lucide-".concat(r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...c})});return s.displayName=r(e),s},c=o("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),d=o("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),u=o("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);var m=e.i(27423);function p(){let{resolvedTheme:e,setTheme:s}=(0,m.useTheme)();return(0,t.jsx)("button",{onClick:()=>{s("light"===e?"dark":"light")},className:"p-2 rounded-lg bg-[rgb(var(--secondary))] hover:bg-[rgb(var(--muted))] transition-colors","aria-label":"Toggle dark mode",title:"Switch to ".concat("light"===e?"dark":"light"," mode"),type:"button",children:"light"===e?(0,t.jsx)(d,{className:"w-5 h-5 text-[rgb(var(--foreground))]"}):(0,t.jsx)(u,{className:"w-5 h-5 text-[rgb(var(--theme-icon-sun))]"})})}function x(){return(0,t.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-[rgb(var(--border))] bg-[rgb(var(--background))] shadow-sm",children:(0,t.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,t.jsxs)(s.default,{href:"/",className:"flex items-center space-x-2 hover:opacity-80 transition-opacity",children:[(0,t.jsx)(c,{className:"w-6 h-6 text-[rgb(var(--training-primary))]"}),(0,t.jsx)("span",{className:"font-bold text-lg text-[rgb(var(--foreground))] whitespace-nowrap",children:"iAODE Training"})]}),(0,t.jsxs)("nav",{className:"hidden md:flex items-center space-x-6",children:[(0,t.jsx)(s.default,{href:"/",className:"text-sm font-medium transition-colors hover:text-[rgb(var(--primary-hover))] text-[rgb(var(--text-secondary))]",children:"Home"}),(0,t.jsx)(s.default,{href:"/train",className:"text-sm font-medium transition-colors hover:text-[rgb(var(--primary-hover))] text-[rgb(var(--text-secondary))]",children:"Train Model"})]}),(0,t.jsx)(p,{})]})})})}},92236,e=>{"use strict";e.s(["default",()=>j],92236);var t=e.i(43476),s=e.i(71645),a=e.i(93963);let r="/api",n={scale_factor:1e4,log_tf:!1,log_idf:!0},l={n_top_peaks:2e4,min_accessibility:.01,max_accessibility:.95,method:"signac",use_raw_counts:!0},i={n_cells:2e4,frac_cells:void 0,use_hvp:!0,hvp_column:"highly_variable",seed:42};async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"scrna",s=new FormData;s.append("file",e);let a=new URL("".concat(window.location.origin).concat(r,"/upload"));a.searchParams.set("data_type",t);let n=await fetch(a.toString(),{method:"POST",body:s});if(!n.ok)throw Error("Failed to upload data");return n.json()}async function c(e){let t=await fetch("".concat(r,"/preprocess/tfidf"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to apply TF-IDF normalization");return t.json()}async function d(e){let t=await fetch("".concat(r,"/preprocess/select-hvp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to select highly variable peaks");return t.json()}async function u(e){let t=await fetch("".concat(r,"/preprocess/subsample"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to subsample data");return t.json()}async function m(e,t){let s=await fetch("".concat(r,"/train"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agparams:e,trainparams:t})});if(!s.ok)throw Error("Failed to start training");return s.json()}async function p(){let e=await fetch("".concat(r,"/state"));if(!e.ok)throw Error("Failed to fetch training state");return e.json()}async function x(e){let t=new URL("".concat(window.location.origin).concat(r,"/download"));t.searchParams.set("embedding_type",e);let s=await fetch(t.toString());if(!s.ok)throw Error("Failed to download embedding");let a=await s.blob(),n=window.URL.createObjectURL(a),l=document.createElement("a");l.href=n;let i=s.headers.get("content-disposition"),o="".concat(e,"_embedding.csv");if(i){let e=i.match(/filename="(.+)"/);(null==e?void 0:e[1])&&(o=e[1])}l.download=o,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(n)}function f(e){let{onUploadSuccess:a}=e,[r,n]=(0,s.useState)(null),[l,i]=(0,s.useState)("scrna"),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(null),p=async()=>{if(!r)return void m("Please select a file");d(!0),m(null);try{let e=await o(r,l);a(e,l)}catch(e){m(e instanceof Error?e.message:"Upload failed")}finally{d(!1)}};return(0,t.jsxs)("div",{className:"card rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Upload Data"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Data Type"}),(0,t.jsxs)("select",{"aria-label":"Data Type",value:l,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-[rgb(var(--border))] bg-[rgb(var(--background))] text-[rgb(var(--foreground))] text-sm focus:outline-none focus:ring-2 focus:ring-[rgb(var(--primary))] disabled:opacity-50",disabled:c,children:[(0,t.jsx)("option",{value:"scrna",className:"bg-[rgb(var(--background))] text-[rgb(var(--foreground))]",children:"scRNA-seq"}),(0,t.jsx)("option",{value:"scatac",className:"bg-[rgb(var(--background))] text-[rgb(var(--foreground))]",children:"scATAC-seq"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Select File"}),(0,t.jsx)("input",{"aria-label":"Select File",type:"file",accept:".h5ad,.h5",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];s&&(n(s),m(null))},disabled:c,className:"w-full px-3 py-2 rounded-lg border text-sm file:mr-4 file:py-1 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium file:btn-secondary"}),r&&(0,t.jsxs)("p",{className:"mt-2 text-sm text-muted",children:["Selected: ",(0,t.jsx)("span",{className:"font-medium",children:r.name})]})]}),u&&(0,t.jsx)("div",{className:"p-3 rounded-lg badge-error",children:(0,t.jsx)("p",{className:"text-sm font-medium",children:u})}),(0,t.jsx)("button",{onClick:p,disabled:!r||c,className:"w-full px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed btn-primary",children:c?"Uploading...":"Upload Data"})]})]})}function h(e){let{dataType:a,onComplete:r}=e,[o,m]=(0,s.useState)("idle"),[p,x]=(0,s.useState)(!1),[f,h]=(0,s.useState)(null),[b,g]=(0,s.useState)(null),[j,y]=(0,s.useState)(n),[N,v]=(0,s.useState)(l),[_,w]=(0,s.useState)(i),[k,S]=(0,s.useState)(!0);if("scatac"!==a)return null;let C=async()=>{x(!0),h(null);try{let e=await c(j);g(e),m("tfidf")}catch(e){h(e instanceof Error?e.message:"TF-IDF normalization failed")}finally{x(!1)}},P=async()=>{x(!0),h(null);try{let e=await d(N);g(e),m("hvp")}catch(e){h(e instanceof Error?e.message:"Peak selection failed")}finally{x(!1)}},T=async()=>{x(!0),h(null);try{let e=k?{..._,frac_cells:void 0}:{..._,n_cells:void 0},t=await u(e);g(t),m("complete"),null==r||r(t)}catch(e){h(e instanceof Error?e.message:"Subsampling failed")}finally{x(!1)}};return(0,t.jsxs)("div",{className:"card rounded-lg p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"scATAC-seq Preprocessing"}),(0,t.jsx)("p",{className:"text-sm text-muted",children:"Sequential preprocessing pipeline required for scATAC-seq data"})]}),f&&(0,t.jsx)("div",{className:"mb-6 p-3 rounded-lg badge-error",children:(0,t.jsx)("p",{className:"text-sm font-medium",children:f})}),b&&(0,t.jsx)("div",{className:"mb-6 p-4 rounded-lg card-inner",children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted mb-1",children:"Current Dataset"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:[b.n_cells.toLocaleString()," cells × ",b.n_peaks.toLocaleString()," peaks"]}),(0,t.jsx)("p",{className:"text-sm text-muted mt-1",children:b.message})]})})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"pb-6 border-t pt-6 first:border-t-0 first:pt-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-xs font-semibold badge-blue px-2.5 py-1 rounded-full",children:"1"}),(0,t.jsx)("h3",{className:"font-semibold",children:"TF-IDF Normalization"}),"idle"!==o&&(0,t.jsx)("span",{className:"text-xs badge-success px-2.5 py-1 rounded-full ml-auto",children:"✓ Complete"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Scale Factor"}),(0,t.jsxs)("select",{"aria-label":"Scale Factor",value:j.scale_factor,onChange:e=>y({...j,scale_factor:Number(e.target.value)}),disabled:"idle"!==o||p,className:"w-full px-3 py-2 rounded-lg border bg-card text-foreground text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)("option",{value:1e4,className:"bg-card text-foreground",children:"10,000 (Standard)"}),(0,t.jsx)("option",{value:1e6,className:"bg-card text-foreground",children:"1,000,000 (Large datasets)"})]}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Normalization scale factor"})]}),(0,t.jsxs)("div",{className:"flex flex-col justify-end space-y-3",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:j.log_tf,onChange:e=>y({...j,log_tf:e.target.checked}),disabled:"idle"!==o||p,className:"rounded border"}),(0,t.jsx)("span",{children:"Log-transform TF"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:j.log_idf,onChange:e=>y({...j,log_idf:e.target.checked}),disabled:"idle"!==o||p,className:"rounded border"}),(0,t.jsx)("span",{children:"Log-transform IDF (Recommended)"})]})]})]}),(0,t.jsx)("button",{onClick:C,disabled:"idle"!==o||p,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:p&&"idle"===o?"Processing...":"Apply TF-IDF Normalization"})]})]}),(0,t.jsxs)("div",{className:"pb-6 border-t pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-xs font-semibold badge-green px-2.5 py-1 rounded-full",children:"2"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Select Highly Variable Peaks"}),("hvp"===o||"complete"===o)&&(0,t.jsx)("span",{className:"text-xs badge-success px-2.5 py-1 rounded-full ml-auto",children:"✓ Complete"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Number of Peaks"}),(0,t.jsx)("input",{"aria-label":"Number of Peaks",type:"number",value:N.n_top_peaks,onChange:e=>v({...N,n_top_peaks:Number(e.target.value)}),disabled:"tfidf"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm",min:1e3,max:1e5,step:1e3}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Top variable peaks to select"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Selection Method"}),(0,t.jsxs)("select",{"aria-label":"Selection Method",value:N.method,onChange:e=>v({...N,method:e.target.value}),disabled:"tfidf"!==o||p,className:"w-full px-3 py-2 rounded-lg border bg-card text-foreground text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)("option",{value:"signac",className:"bg-card text-foreground",children:"Signac (Recommended)"}),(0,t.jsx)("option",{value:"snapatac2",className:"bg-card text-foreground",children:"SnapATAC2"}),(0,t.jsx)("option",{value:"deviance",className:"bg-card text-foreground",children:"Binomial Deviance"})]}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Peak selection algorithm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Min Accessibility"}),(0,t.jsx)("input",{"aria-label":"Min Accessibility",type:"number",value:N.min_accessibility,onChange:e=>v({...N,min_accessibility:Number(e.target.value)}),disabled:"tfidf"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm",min:0,max:1,step:.01}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Filter peaks in < X% cells"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Max Accessibility"}),(0,t.jsx)("input",{"aria-label":"Max Accessibility",type:"number",value:N.max_accessibility,onChange:e=>v({...N,max_accessibility:Number(e.target.value)}),disabled:"tfidf"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm",min:0,max:1,step:.01}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Filter ubiquitous peaks in > X% cells"})]})]}),(0,t.jsx)("button",{onClick:P,disabled:"tfidf"!==o||p,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:p&&"tfidf"===o?"Processing...":"Select Variable Peaks"})]})]}),(0,t.jsxs)("div",{className:"pb-6 border-t pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-xs font-semibold badge-purple px-2.5 py-1 rounded-full",children:"3"}),(0,t.jsx)("h3",{className:"font-semibold",children:"Subsample Data"}),(0,t.jsx)("span",{className:"text-xs text-muted",children:"(Optional)"}),"complete"===o&&(0,t.jsx)("span",{className:"text-xs badge-success px-2.5 py-1 rounded-full ml-auto",children:"✓ Complete"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-4 p-3 rounded-lg card-inner",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,t.jsx)("input",{type:"radio",checked:k,onChange:()=>S(!0),disabled:"hvp"!==o||p,className:"text-primary"}),(0,t.jsx)("span",{children:"Sample by cell count"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,t.jsx)("input",{type:"radio",checked:!k,onChange:()=>S(!1),disabled:"hvp"!==o||p,className:"text-primary"}),(0,t.jsx)("span",{children:"Sample by fraction"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[k?(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Number of Cells"}),(0,t.jsx)("input",{"aria-label":"Number of Cells",type:"number",value:_.n_cells||"",onChange:e=>w({..._,n_cells:Number(e.target.value)}),disabled:"hvp"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm",min:100,step:100,placeholder:"e.g., 10000"}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Number of cells to randomly sample"})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Fraction (0-1)"}),(0,t.jsx)("input",{"aria-label":"Fraction",type:"number",value:_.frac_cells||"",onChange:e=>w({..._,frac_cells:Number(e.target.value)}),disabled:"hvp"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm",min:.01,max:1,step:.1,placeholder:"e.g., 0.5"}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Fraction of total cells to sample"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Random Seed"}),(0,t.jsx)("input",{"aria-label":"Random Seed",type:"number",value:_.seed,onChange:e=>w({..._,seed:Number(e.target.value)}),disabled:"hvp"!==o||p,className:"w-full px-3 py-2 rounded-lg border text-sm"}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"For reproducible sampling"})]})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.use_hvp,onChange:e=>w({..._,use_hvp:e.target.checked}),disabled:"hvp"!==o||p,className:"rounded border"}),(0,t.jsx)("span",{children:"Filter to highly variable peaks only"})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:T,disabled:"hvp"!==o||p,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:p&&"hvp"===o?"Processing...":"Apply Subsampling"}),(0,t.jsx)("button",{onClick:()=>{m("complete"),b&&(null==r||r(b))},disabled:"hvp"!==o||p,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Skip Subsampling"})]})]})]})]})]})}function b(e){let{onSubmit:a,disabled:r}=e,[n,l]=(0,s.useState)({layer:"counts",recon:1,irecon:0,beta:1,dip:0,tc:0,info:0,hidden_dim:128,latent_dim:10,i_dim:2,use_ode:!1,loss_mode:"nb",lr:1e-4,vae_reg:.5,ode_reg:.5,train_size:.7,val_size:.15,test_size:.15,batch_size:128,random_seed:42,encoder_type:"mlp",encoder_num_layers:2,encoder_n_heads:4,encoder_d_model:void 0}),[i,o]=(0,s.useState)({epochs:100,patience:20,val_every:5,early_stop:!0});return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(n,i)},className:"card rounded-lg p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Training Configuration"}),(0,t.jsx)("p",{className:"text-sm text-muted",children:"Configure model architecture and training parameters"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"pb-6 border-t pt-6 first:border-t-0 first:pt-0",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"Model Architecture"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Hidden Dimension"}),(0,t.jsx)("input",{"aria-label":"Hidden Dimension",type:"number",value:n.hidden_dim,onChange:e=>l({...n,hidden_dim:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:32,max:512}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Size of encoder/decoder hidden layers"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Latent Dimension"}),(0,t.jsx)("input",{"aria-label":"Latent Dimension",type:"number",value:n.latent_dim,onChange:e=>l({...n,latent_dim:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:2,max:100}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Latent embedding dimension"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Interpretable Dimension"}),(0,t.jsx)("input",{"aria-label":"Interpretable Dimension",type:"number",value:n.i_dim,onChange:e=>l({...n,i_dim:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:2,max:10}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Interpretable embedding dimension"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Data Layer"}),(0,t.jsx)("input",{"aria-label":"Data Layer",type:"text",value:n.layer,onChange:e=>l({...n,layer:e.target.value}),className:"w-full px-3 py-2 rounded-lg border text-sm",placeholder:"counts or X"}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"AnnData layer (counts or X for .X)"})]})]})]}),(0,t.jsxs)("div",{className:"pb-6 border-t pt-6",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"Encoder Architecture"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Encoder Type"}),(0,t.jsxs)("select",{"aria-label":"Encoder Type",value:n.encoder_type,onChange:e=>l({...n,encoder_type:e.target.value}),className:"w-full px-3 py-2 rounded-lg border bg-card text-foreground text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)("option",{value:"mlp",className:"bg-card text-foreground",children:"MLP (Multi-Layer Perceptron)"}),(0,t.jsx)("option",{value:"mlp_residual",className:"bg-card text-foreground",children:"MLP with Residual Connections"}),(0,t.jsx)("option",{value:"linear",className:"bg-card text-foreground",children:"Linear"}),(0,t.jsx)("option",{value:"transformer",className:"bg-card text-foreground",children:"Transformer"})]}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Neural network architecture for encoder"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Number of Encoder Layers"}),(0,t.jsx)("input",{"aria-label":"Number of Encoder Layers",type:"number",value:n.encoder_num_layers,onChange:e=>l({...n,encoder_num_layers:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:1,max:10}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Depth of encoder network"})]}),"transformer"===n.encoder_type&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Attention Heads"}),(0,t.jsx)("input",{"aria-label":"Attention Heads",type:"number",value:n.encoder_n_heads,onChange:e=>l({...n,encoder_n_heads:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:1,max:16}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Number of attention heads (transformer only)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Transformer Model Dimension"}),(0,t.jsx)("input",{"aria-label":"Transformer Model Dimension",type:"number",value:n.encoder_d_model||"",onChange:e=>l({...n,encoder_d_model:e.target.value?Number(e.target.value):void 0}),className:"w-full px-3 py-2 rounded-lg border text-sm",placeholder:"Auto (= hidden_dim)",min:32,max:1024}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Leave empty to use hidden_dim"})]})]})]})]}),(0,t.jsxs)("div",{className:"pb-6 border-t pt-6",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"Loss Configuration"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Loss Mode"}),(0,t.jsxs)("select",{"aria-label":"Loss Mode",value:n.loss_mode,onChange:e=>l({...n,loss_mode:e.target.value}),className:"w-full px-3 py-2 rounded-lg border bg-card text-foreground text-sm focus:outline-none focus:ring-2 focus:ring-ring",children:[(0,t.jsx)("option",{value:"mse",className:"bg-card text-foreground",children:"MSE (Mean Squared Error)"}),(0,t.jsx)("option",{value:"nb",className:"bg-card text-foreground",children:"NB (Negative Binomial)"}),(0,t.jsx)("option",{value:"zinb",className:"bg-card text-foreground",children:"ZINB (Zero-Inflated NB)"})]}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Reconstruction loss function"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Reconstruction Weight"}),(0,t.jsx)("input",{"aria-label":"Reconstruction Weight",type:"number",step:"0.1",value:n.recon,onChange:e=>l({...n,recon:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:0}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Main reconstruction loss weight"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Beta (KL Weight)"}),(0,t.jsx)("input",{"aria-label":"Beta (KL Weight)",type:"number",step:"0.1",value:n.beta,onChange:e=>l({...n,beta:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:0}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Beta-VAE regularization weight"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Interpretable Recon Weight"}),(0,t.jsx)("input",{"aria-label":"Interpretable Recon Weight",type:"number",step:"0.1",value:n.irecon,onChange:e=>l({...n,irecon:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:0}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Interpretable reconstruction weight"})]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:n.use_ode,onChange:e=>l({...n,use_ode:e.target.checked}),className:"rounded border"}),(0,t.jsx)("span",{className:"font-medium",children:"Enable ODE (Ordinary Differential Equations)"})]}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1 ml-6",children:"For trajectory modeling and dynamics learning"})]})]}),(0,t.jsxs)("div",{className:"pb-6 border-t pt-6",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"Training Settings"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Learning Rate"}),(0,t.jsx)("input",{"aria-label":"Learning Rate",type:"number",step:"any",value:n.lr,onChange:e=>l({...n,lr:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:0}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Adam optimizer learning rate"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Batch Size"}),(0,t.jsx)("input",{"aria-label":"Batch Size",type:"number",value:n.batch_size,onChange:e=>l({...n,batch_size:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:16,max:1024,step:16}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Training batch size"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Max Epochs"}),(0,t.jsx)("input",{"aria-label":"Max Epochs",type:"number",value:i.epochs,onChange:e=>o({...i,epochs:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:10,max:1e3}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Maximum training epochs"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2 text-muted",children:"Early Stop Patience"}),(0,t.jsx)("input",{"aria-label":"Early Stop Patience",type:"number",value:i.patience,onChange:e=>o({...i,patience:Number(e.target.value)}),className:"w-full px-3 py-2 rounded-lg border text-sm",min:5,max:100}),(0,t.jsx)("p",{className:"text-xs text-muted mt-1",children:"Epochs to wait before stopping"})]})]})]})]}),(0,t.jsx)("button",{type:"submit",disabled:r,className:"w-full px-4 py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed btn-primary mt-6",children:r?"Training in Progress...":"Start Training"})]})}function g(){let[e,a]=(0,s.useState)(null),[r,n]=(0,s.useState)(null);(0,s.useEffect)(()=>{let t=async()=>{try{let e=await p();a(e)}catch(t){e||a({status:"idle",current_epoch:0,message:"Waiting for backend connection..."})}};t();let s=setInterval(t,e?"training"===e.status||"initializing"===e.status?3e3:"completed"===e.status||"error"===e.status?1e4:5e3:5e3);return()=>clearInterval(s)},[null==e?void 0:e.status]);let l=async e=>{n(e);try{await x(e)}catch(e){alert("Download failed: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{n(null)}};if(!e)return(0,t.jsx)("div",{className:"space-y-4 p-6 rounded-lg card",children:(0,t.jsx)("p",{className:"text-muted",children:"Loading state..."})});let i="training"===e.status||"initializing"===e.status,o="completed"===e.status;return(0,t.jsxs)("div",{className:"space-y-4 p-6 rounded-lg card",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Training Status"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Status:"}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(o?"badge-success":i?"badge-info":"error"===e.status?"badge-error":"badge-idle"),children:e.status})]}),e.current_epoch>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Current Epoch:"}),(0,t.jsx)("span",{className:"text-sm",children:e.current_epoch})]}),e.message&&(0,t.jsx)("div",{className:"p-3 rounded-lg card-inner",children:(0,t.jsx)("p",{className:"text-sm",children:e.message})}),i&&(0,t.jsx)("div",{className:"w-full rounded-full h-2 overflow-hidden progress-bar",children:(0,t.jsx)("div",{className:"h-full animate-pulse progress-fill"})}),o&&(0,t.jsxs)("div",{className:"space-y-2 pt-4 border-t-divider",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Download Embeddings"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)("button",{onClick:()=>l("latent"),disabled:null!==r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 btn-primary",children:"latent"===r?"Downloading...":"Latent"}),(0,t.jsx)("button",{onClick:()=>l("interpretable"),disabled:null!==r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors disabled:opacity-50 btn-training",children:"interpretable"===r?"Downloading...":"Interpretable"})]})]})]})]})}function j(){let[e,r]=(0,s.useState)(null),[n,l]=(0,s.useState)("scrna"),[i,o]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),u=(0,s.useRef)(null),x=async(e,t)=>{d(!0),setTimeout(()=>{u.current&&u.current.scrollIntoView({behavior:"smooth",block:"start"}),u.current||window.scrollTo({top:0,behavior:"smooth"})},100);try{await m(e,t)}catch(e){alert("Training failed: ".concat(e instanceof Error?e.message:"Unknown error")),d(!1)}};return(0,s.useEffect)(()=>{if(!c)return;let e=setInterval(async()=>{try{let t=await p();("completed"===t.status||"failed"===t.status||"idle"===t.status)&&(d(!1),clearInterval(e))}catch(e){console.error("Failed to poll training state:",e)}},2e3);return()=>clearInterval(e)},[c]),(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(a.Header,{}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{ref:u,children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Model Training"}),(0,t.jsx)("p",{className:"text-muted mb-8",children:"Upload your data, configure preprocessing (if needed), and train the model"})]}),e&&(0,t.jsx)("div",{className:"mb-6 p-4 rounded-lg badge-info",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm font-medium mb-1",children:["✓ ","scatac"===n?"scATAC-seq":"scRNA-seq"," Data Loaded"]}),(0,t.jsxs)("p",{className:"text-sm",children:[e.n_cells.toLocaleString()," cells × ",e.n_genes.toLocaleString()," ","scatac"===n?"peaks":"genes"]})]}),"scatac"===n&&!i&&(0,t.jsx)("span",{className:"text-xs badge-purple px-3 py-1.5 rounded-full",children:"Preprocessing Required"}),i&&(0,t.jsx)("span",{className:"text-xs badge-success px-3 py-1.5 rounded-full",children:"Ready to Train"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(f,{onUploadSuccess:(e,t)=>{r(e),l(t),o("scrna"===t)}})}),(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsx)(g,{})}),e&&"scatac"===n&&!i&&(0,t.jsx)("div",{className:"lg:col-span-3",children:(0,t.jsx)(h,{dataType:n,onComplete:e=>{r({n_cells:e.n_cells,n_genes:e.n_peaks}),o(!0)}})}),e&&i&&(0,t.jsx)("div",{className:"lg:col-span-3",children:(0,t.jsx)(b,{onSubmit:x,disabled:c})})]})]})]})}}]);